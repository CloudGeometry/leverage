name: 

on: [pull_request, workflow_dispatch]

jobs:

  build:

    runs-on: ubuntu-latest 
    steps:
      - uses: actions/checkout@v2

      - uses: actions/setup-python@v2

      - name: run_unit_tests
        run: |
          echo "[INFO] Building image"
          make build-image

          echo "[INFO] Running unit tests"
          make test-unit-no-cov
        shell: bash

      - uses: act10ns/slack@v1
        with: 
          status: ${{ job.status }}
          channel: $SLACK_CI_CHANNEL
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
          SLACK_CI_CHANNEL: ${{ secrets.SLACK_CI_CHANNEL }}
